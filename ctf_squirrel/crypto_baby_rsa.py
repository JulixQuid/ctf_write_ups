from gmpy2 import isqrt

def factor_n(n):
    a = isqrt(n)  # Start near sqrt(n)
    while True:
        b_squared = a**2 - n
        if b_squared >= 0:
            b = isqrt(b_squared)
            if b**2 == b_squared:  # Check if perfect square
                return (a - b, a + b)  # p, q
        a += 1

n = 26518484190072684543796636642573643429663718007657844401363773206659586306986264997767920520901884078894807042866105584826044096909054367742753454178100533852686155634326578229244464083405472076784252798532101323300927917033985149599262487556178538148122012479094592746981412717431260240328326665253193374956717147239124238669998383943846418315819353858592278242580832695035016713351286816376107787722262574185450560176240134182669922757134881941918668067864082251416681188295948127121973857376227427652243249227143249036846400440184395983449367274506961173876131312502878352761335998067274325965774900643209446005663  # From easy_rsa.txt
p, q = factor_n(n)
print("p =", p)
print("q =", q)
assert(p*q==n)
#p = 162844969802793369991428601458295181570536706599609454664094976374150994306422002904013120826461924570049490132847808181540893008813305140934077173993221511741114503090171789361722157385749936254368680979467760601708231528381466644171627681117469122398345322805274888367547624418417938030736404407437613225877
#q = 162844969802793369991428601458295181570536706599609454664094976374150994306422002904013120826461924570049490132847808181540893008813305140934077173993327436461912048726815700038563854363515704550897541580442036450232099126331779281555115480827104127689657088570096620633332930485612118325060906186228586482019
